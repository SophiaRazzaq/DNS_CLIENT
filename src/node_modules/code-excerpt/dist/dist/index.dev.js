"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _convertToSpaces = _interopRequireDefault(require("convert-to-spaces"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var generateLineNumbers = function generateLineNumbers(line, around) {
  var lineNumbers = [];
  var min = line - around;
  var max = line + around;

  for (var lineNumber = min; lineNumber <= max; lineNumber++) {
    lineNumbers.push(lineNumber);
  }

  return lineNumbers;
};

var codeExcerpt = function codeExcerpt(source, line) {
  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};

  var _a;

  if (typeof source !== 'string') {
    throw new TypeError('Source code is missing.');
  }

  if (!line || line < 1) {
    throw new TypeError('Line number must start from `1`.');
  }

  var lines = (0, _convertToSpaces["default"])(source).split(/\r?\n/);

  if (line > lines.length) {
    return;
  }

  return generateLineNumbers(line, (_a = options.around) !== null && _a !== void 0 ? _a : 3).filter(function (line) {
    return lines[line - 1] !== undefined;
  }).map(function (line) {
    return {
      line: line,
      value: lines[line - 1]
    };
  });
};

var _default = codeExcerpt;
exports["default"] = _default;